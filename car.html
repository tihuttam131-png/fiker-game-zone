<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Simple Car Game — Single File</title>
<meta name="viewport" content="width=device-width,initial-scale=1" />
<style>
  :root{--bg:#2b2b2b;--road:#3a3a3a;--line:#fff;--panel:#111}
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:var(--bg);color:#fff;display:flex;gap:20px;min-height:100vh;align-items:flex-start;justify-content:center;padding:20px;}
  .wrapper{display:flex;gap:20px;align-items:flex-start;max-width:1100px;width:100%;}
  .left{background:linear-gradient(180deg,#111,#000);padding:14px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.6);}
  canvas{display:block;background:linear-gradient(#2a2a2a,#212121);border-radius:8px;border:6px solid #000;width:800px;height:600px;}
  .controls{margin-top:12px;display:flex;gap:8px;align-items:center;justify-content:center;}
  .panel{width:260px;background:var(--panel);padding:14px;border-radius:12px;box-shadow:0 8px 30px rgba(0,0,0,0.6);display:flex;flex-direction:column;gap:12px;}
  label{font-size:14px;color:#ddd}
  select, button{width:100%;padding:10px;border-radius:8px;border:0;font-size:16px;cursor:pointer;}
  button.primary{background:#1db954;color:#fff;font-weight:600;}
  button.secondary{background:#444;color:#fff;}
  .score{font-size:22px;text-align:center;background:#0f0f0f;padding:10px;border-radius:8px;}
  .hint{font-size:13px;color:#bbb}
  .touch-controls{display:flex;gap:8px}
  .touch-controls button{flex:1;padding:14px;font-size:18px}
  footer{font-size:12px;color:#888;text-align:center;margin-top:8px}
  @media(max-width:920px){canvas{width:100%;height:auto}.wrapper{flex-direction:column;align-items:center}}
  .back-button {position: absolute;top: 20px;left: 20px;background-color: #3498db;color: white;padding: 8px 16px;border-radius: 8px;text-decoration: none;font-weight: bold;box-shadow: 0 2px 6px rgba(0,0,0,0.2);transition: background 0.3s;}
  .back-button:hover {background-color: #2980b9;}
  .controls {
  display: flex;
  flex-direction: column;
  gap: 8px;
  align-items: center;
}
.touch-controls {
  width: 100%;
  display: flex;
  gap: 8px;
  justify-content: center;
}
.touch-controls button {
  flex: 1;
  padding: 14px;
  font-size: 18px;
}

</style>
</head>
<body>
<a href="index.html" class="back-button">← Back</a>
<div class="wrapper">
  <div class="left">
    <canvas id="game" width="800" height="600"></canvas>
    <div class="controls">
      <button id="startBtn" class="primary">Start</button>
      <button id="pauseBtn" class="secondary">Pause</button>
      <button id="restartBtn" class="secondary">Restart</button>
    </div>
  </div>
  <aside class="panel" aria-label="Game panel">
    <div>
      <label for="difficulty">Difficulty</label>
      <select id="difficulty">
        <option value="easy">Easy</option>
        <option value="medium" selected>Medium</option>
        <option value="hard">Hard</option>
      </select>
    </div>
    <div class="score" id="scoreBox">Score: 0</div>
    <div>
      <label>Controls</label>
      <div class="hint">Use ← → or A / D to move. Tap the left/right buttons on touch.</div>
      <div class="touch-controls" style="margin-top:8px">
        <button id="touchLeft">◀</button>
        <button id="touchRight">▶</button>
      </div>
    </div>
    <div>
      <label>Game Options</label>
      <div style="display:flex;gap:8px;margin-top:8px">
        <button id="toggleMusic" class="secondary">Sound: Off</button>
        <button id="toggleDebug" class="secondary">Debug: Off</button>
      </div>
    </div>
    <footer>Simple Car Game</footer>
  </aside>
</div>
<div class="controls">
  <button id="startBtn" class="primary">Start</button>
  <div class="touch-controls" style="margin-top:8px">
    <button id="touchLeft">◀</button>
    <button id="touchRight">▶</button>
  </div>
  <button id="pauseBtn" class="secondary">Pause</button>
  <button id="restartBtn" class="secondary">Restart</button>
</div>

<script>
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');
const scoreBox = document.getElementById('scoreBox');
const startBtn = document.getElementById('startBtn');
const pauseBtn = document.getElementById('pauseBtn');
const restartBtn = document.getElementById('restartBtn');
const difficultySelect = document.getElementById('difficulty');
const touchLeft = document.getElementById('touchLeft');
const touchRight = document.getElementById('touchRight');
const toggleMusic = document.getElementById('toggleMusic');
const toggleDebug = document.getElementById('toggleDebug');
let W = canvas.width, H = canvas.height;
let animId = null, gameRunning = false, gamePaused = false, debug = false, soundOn = false;
let player, obstacles, road, spawnTimer, score, speedMultiplier;
const DIFFICULTY = {easy:{obstacleFreq:1600,maxSpeed:2,laneCount:3},medium:{obstacleFreq:1200,maxSpeed:3,laneCount:3},hard:{obstacleFreq:900,maxSpeed:4.2,laneCount:4}};
function resetGame(){
  W=canvas.width;H=canvas.height;
  player={w:50,h:90,x:W/2-25,y:H-140,speed:8,color:'#1e90ff',lane:null};
  const diff=DIFFICULTY[difficultySelect.value];
  road={laneCount:diff.laneCount,laneWidth:Math.floor(W*0.5/diff.laneCount),left:Math.floor((W-Math.floor(W*0.5))/2),right:null};
  road.right=road.left+road.laneWidth*road.laneCount;
  const middleLane=Math.floor(diff.laneCount/2);
  player.x=road.left+middleLane*road.laneWidth+(road.laneWidth-player.w)/2;
  obstacles=[];spawnTimer=0;score=0;speedMultiplier=1;updateScoreUI();
  // add initial enemy cars
  for(let i=0;i<3;i++){spawnObstacle(true);}
}
function rnd(a,b){return Math.random()*(b-a)+a;}
function draw(){
  ctx.fillStyle='#228B22';ctx.fillRect(0,0,W,H); // grass
  ctx.fillStyle='#555';ctx.fillRect(road.left-40,0,(road.right-road.left)+80,H); // road
  ctx.strokeStyle='#fff';ctx.lineWidth=6;ctx.setLineDash([40,30]);
  for(let i=1;i<road.laneCount;i++){const x=road.left+i*road.laneWidth;ctx.beginPath();ctx.moveTo(x,0);ctx.lineTo(x,H);ctx.stroke();}
  ctx.setLineDash([]);
  // obstacles
  for(const o of obstacles){
    ctx.fillStyle='#c0392b';roundRect(ctx,o.x,o.y,o.w,o.h,6,true,false);
  }
  // player car
  ctx.fillStyle=player.color;roundRect(ctx,player.x,player.y,player.w,player.h,8,true,false);
  ctx.fillStyle='#aee';roundRect(ctx,player.x+8,player.y+16,player.w-16,player.h/3,6,true,false);
  if(debug){ctx.strokeStyle='#f0f';ctx.strokeRect(player.x,player.y,player.w,player.h);}
  ctx.fillStyle='#fff';ctx.font='18px monospace';ctx.fillText('Score: '+score,14,28);
}
function roundRect(ctx,x,y,w,h,r,fill,stroke){if(typeof stroke==='undefined')stroke=true;if(typeof r==='undefined')r=5;ctx.beginPath();ctx.moveTo(x+r,y);ctx.arcTo(x+w,y,x+w,y+h,r);ctx.arcTo(x+w,y+h,x,y+h,r);ctx.arcTo(x,y+h,x,y,r);ctx.arcTo(x,y,x+r,y,r);ctx.closePath();if(fill)ctx.fill();if(stroke)ctx.stroke();}
function spawnObstacle(initial=false){const diff=DIFFICULTY[difficultySelect.value];const lane=Math.floor(rnd(0,diff.laneCount));const w=road.laneWidth-20;const h=rnd(60,120);const x=road.left+lane*road.laneWidth+(road.laneWidth-w)/2;const o={x:x,y:initial?-h-rnd(50,300):-h-20,w:w,h:h,speed:rnd(2,diff.maxSpeed)*speedMultiplier+1.2,color:'#c0392b'};obstacles.push(o);}
function update(dt){spawnTimer+=dt;const diff=DIFFICULTY[difficultySelect.value];const freq=diff.obstacleFreq/Math.max(0.6,1-Math.min(0.8,score/180));if(spawnTimer>freq){spawnTimer=0;spawnObstacle();}
for(let i=obstacles.length-1;i>=0;i--){const o=obstacles[i];o.y+=o.speed;if(o.y>H+200){obstacles.splice(i,1);score++;if(score%6===0)speedMultiplier+=0.06;updateScoreUI();}else if(rectIntersect(player.x,player.y,player.w,player.h,o.x,o.y,o.w,o.h)){gameOver();return;}}}
function rectIntersect(ax,ay,aw,ah,bx,by,bw,bh){return ax<bx+bw&&ax+aw>bx&&ay<by+bh&&ay+ah>by;}
const keys={};window.addEventListener('keydown',e=>{keys[e.key.toLowerCase()]=true;if(e.key===' '){if(!gameRunning)startGame();else if(gamePaused)resumeGame();}});window.addEventListener('keyup',e=>{keys[e.key.toLowerCase()]=false;});
let touchMoveLeft=false,touchMoveRight=false;
touchLeft.addEventListener('touchstart',e=>{e.preventDefault();touchMoveLeft=true;},{passive:false});
touchLeft.addEventListener('touchend',()=>{touchMoveLeft=false;});
touchRight.addEventListener('touchstart',e=>{e.preventDefault();touchMoveRight=true;},{passive:false});
touchRight.addEventListener('touchend',()=>{touchMoveRight=false;});
let last=0;function loop(ts){if(!gameRunning||gamePaused){last=0;return;}if(!last)last=ts;const dt=ts-last;last=ts;const left=keys['arrowleft']||keys['a']||touchMoveLeft;const right=keys['arrowright']||keys['d']||touchMoveRight;if(left&&!right){player.x-=player.speed;}else if(right&&!left){player.x+=player.speed;}player.x=Math.max(road.left+6,Math.min(road.right-player.w-6,player.x));update(dt);draw();animId=requestAnimationFrame(loop);}
function startGame(){if(gameRunning)return;resetGame();gameRunning=true;gamePaused=false;startBtn.textContent='Running';pauseBtn.textContent='Pause';last=0;animId=requestAnimationFrame(loop);}
function pauseGame(){if(!gameRunning)return;gamePaused=true;startBtn.textContent='Start';pauseBtn.textContent='Resume';if(animId)cancelAnimationFrame(animId);}
function resumeGame(){if(!gameRunning)return;gamePaused=false;pauseBtn.textContent='Pause';last=0;animId=requestAnimationFrame(loop);}
function restart(){if(animId)cancelAnimationFrame(animId);gameRunning=false;gamePaused=false;startBtn.textContent='Start';pauseBtn.textContent='Pause';resetGame();draw();}
function gameOver(){gameRunning=false;if(animId)cancelAnimationFrame(animId);ctx.fillStyle='rgba(0,0,255,0.6)';ctx.fillRect(0,0,W,H);ctx.fillStyle='#fff';ctx.font='48px system-ui,Arial';ctx.textAlign='center';ctx.fillText('YOU LOSE',W/2,H/2-20);ctx.font='24px monospace';ctx.fillText('Score: '+score,W/2,H/2+20);startBtn.textContent='Start';pauseBtn.textContent='Pause';}
function updateScoreUI(){scoreBox.textContent='Score: '+score;}
toggleDebug.addEventListener('click',()=>{debug=!debug;toggleDebug.textContent='Debug: '+(debug?'On':'Off');draw();});
toggleMusic.addEventListener('click',()=>{soundOn=!soundOn;toggleMusic.textContent='Sound: '+(soundOn?'On':'Off');});
startBtn.addEventListener('click',()=>{if(!gameRunning)startGame();else if(gamePaused)resumeGame();});
pauseBtn.addEventListener('click',()=>{if(!gameRunning)return;if(gamePaused)resumeGame();else pauseGame();});
restartBtn.addEventListener('click',restart);
difficultySelect.addEventListener('change',()=>{restart();});
resetGame();draw();
window.addEventListener('resize',()=>{draw();});
</script>
</body>
</html>
